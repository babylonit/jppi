---
const pathname = Astro.url.pathname;

const navItems = [
  { name: 'Home', href: '/' },
  { name: 'Disposable Paper Cups', href: '/disposable-paper-cups' },
  { name: 'Offset Printing', href: '/offset-printing' },
  { name: 'Paper Packaging', href: '/paper-packaging' },
  { name: 'Distributor', href: '/distributor', highlight: true },
  { name: 'Gallery', href: '/gallery' },
  { name: 'Contact', href: '/contact' },
  { name: 'FAQ', href: '/faq' },
];

const isActive = (path: string) => {
  if (path === '/') {
    return pathname === '/';
  }
  return pathname.startsWith(path);
};
---

<header class="bg-white sticky top-0 z-50 shadow-sm">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center py-4 md:justify-start md:space-x-10">
      <!-- Logo -->
      <div class="flex justify-start lg:w-0 lg:flex-1">
        <a href="/" class="flex items-center">
          <span class="sr-only">Joana Paper Product Industry</span>
          <img class="h-10 w-auto sm:h-12" src="/images/joana-logo.png" alt="Joana Paper Product Industry Logo">
        </a>
      </div>
      
      <!-- Mobile menu button -->
      <div class="-mr-2 -my-2 md:hidden">
        <button type="button" id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-700 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500">
          <span class="sr-only">Open menu</span>
          <!-- Menu icon -->
          <i class="fas fa-bars h-6 w-6" aria-hidden="true"></i>
        </button>
      </div>
      
      <!-- Desktop navigation -->
      <nav class="hidden md:flex space-x-8">
        {navItems.map(item => (
          <a 
            href={item.href}
            class:list={[
              'text-base font-medium transition-colors hover:text-primary-600 relative',
              isActive(item.href) ? 'text-primary-600 font-semibold' : 'text-gray-700',
              item.highlight && !isActive(item.href) ? 'distributor-highlight' : ''
            ]}
          >
            {item.name}
            {item.highlight && !isActive(item.href) && (
              <span class="absolute -top-1 -right-2 flex h-3 w-3">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-3 w-3 bg-primary-500"></span>
              </span>
            )}
          </a>
        ))}
      </nav>
      
      <!-- CTA button -->
      <div class="hidden md:flex items-center justify-end md:flex-1 lg:w-0">
        <a href="tel:+8801976724401" class="btn btn-primary shadow-sm whitespace-nowrap px-4">
          01976724401
        </a>
      </div>
    </div>
  </div>
  
  <!-- Mobile menu, show/hide based on mobile menu state -->
  <div id="mobile-menu" class="hidden md:hidden absolute top-full left-0 w-full bg-white shadow-lg rounded-b-lg">
    <div class="pt-2 pb-4 px-5 space-y-1">
      {navItems.map(item => (
        <a 
          href={item.href}
          class:list={[
            'block px-3 py-2 rounded-md text-base font-medium relative',
            isActive(item.href) ? 'text-primary-700 bg-primary-50' : 'text-gray-700 hover:bg-gray-50 hover:text-primary-600',
            item.highlight && !isActive(item.href) ? 'mobile-distributor-highlight' : ''
          ]}
        >
          {item.name}
          {item.highlight && !isActive(item.href) && (
            <span class="absolute top-2 right-3 flex h-2 w-2">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary-400 opacity-75"></span>
              <span class="relative inline-flex rounded-full h-2 w-2 bg-primary-500"></span>
            </span>
          )}
        </a>
      ))}
      <a href="/contact" class="block w-full mt-4 btn btn-primary text-center">
        Get a Quote
      </a>
    </div>
  </div>
</header>

<style>
  .distributor-highlight {
    /* Subtle glow effect */
    text-shadow: 0 0 5px rgba(0, 128, 1, 0.3);
    font-weight: 600;
    /* Subtle scale effect on hover */
    transition: transform 0.3s ease, text-shadow 0.3s ease;
  }
  
  .distributor-highlight:hover {
    transform: scale(1.05);
    text-shadow: 0 0 8px rgba(0, 128, 1, 0.5);
  }
  
  .mobile-distributor-highlight {
    font-weight: 600;
  }
  
  /* Sparkle animation using pseudo-element */
  .distributor-highlight::after {
    content: 'âœ¨';
    position: absolute;
    top: -8px;
    right: -12px;
    font-size: 14px;
    animation: sparkle 1.5s infinite;
    opacity: 0.9;
  }
  
  @keyframes sparkle {
    0% { opacity: 0.3; transform: scale(0.8) rotate(0deg); }
    50% { opacity: 1; transform: scale(1.1) rotate(10deg); }
    100% { opacity: 0.3; transform: scale(0.8) rotate(0deg); }
  }
</style>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  
  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener('click', () => {
      const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
      mobileMenuButton.setAttribute('aria-expanded', (!isExpanded).toString());
      mobileMenu.classList.toggle('hidden');
    });
  }
</script>